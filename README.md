# AI Log-Analyzer mit Docker, Mailserver und Kubernetes-Unterst√ºtzung

Ein intelligenter SSH-basierter Linux-Log-Analyzer mit integriertem Ollama-Chat, Docker-Container-Analyse, Mailserver-√úberwachung und Kubernetes-Cluster-Analyse.

## üåç **Dynamische AI-gesteuerte Internationalisierung**
- **POSIX-konform**: Verwendet Standard-gettext ohne externe Abh√§ngigkeiten
- **Automatische Spracherkennung**: Erkennt Sprache aus Shell-Locale (`LANG`, `LC_ALL`, `LC_MESSAGES`)
- **Unterst√ºtzte Sprachen**: Deutsch (Standard) und Englisch
- **Dynamische √úbersetzung**: Automatische KI-√úbersetzung f√ºr unbekannte Locales
- **Ollama-Integration**: Echtzeit-√úbersetzungsgenerierung mit AI
- **Fallback-System**: Robuste √úbersetzungen auch ohne gettext-Dateien
- **Persistierung**: Dynamische √úbersetzungen werden gespeichert und wiederverwendet
- **Runtime-Sprachwechsel**: Wechsel zwischen Sprachen zur Laufzeit

## üöÄ Features

### üîç **Umfassende System-Analyse**
- **Basis-System-Informationen**: Hostname, Distribution, Kernel, CPU, RAM, Uptime
- **Speicherplatz-Analyse**: Disk-Usage, gr√∂√üte Dateien und Verzeichnisse
- **Service-Status**: Laufende Services und Prozesse
- **Sicherheits-Analyse**: Anmeldungen, fehlgeschlagene Login-Versuche
- **Performance-Monitoring**: CPU, Memory, Load Average

### ‚ò∏Ô∏è **Kubernetes-Cluster-Analyse**
- **Automatische Erkennung**: Pr√ºft `kubectl` und `k9s` Verf√ºgbarkeit
- **Cluster-Informationen**: Version, Nodes, Namespaces, Pods, Services
- **Problem-Erkennung**: Nicht-ready Nodes, nicht-running Pods, kritische Events
- **Ressourcen-Monitoring**: Node- und Pod-Ressourcen-Auslastung
- **Storage-Analyse**: Persistent Volumes und deren Status

### üê≥ **Docker-Container-Analyse**
- **Automatische Erkennung**: Pr√ºft Docker-Installation und -Daemon
- **Container-√úberwachung**: Laufende und gestoppte Container
- **Image-Management**: Verf√ºgbare Images und ungenutzte Images
- **Volume-√úberwachung**: Docker-Volumes und deren Status
- **Netzwerk-Analyse**: Docker-Netzwerke und deren Konfiguration
- **Problem-Erkennung**: Gestoppte Container, ungenutzte Ressourcen

### üìß **Mailserver-Analyse**
- **Mailcow-Integration**: Container-Status, Logs, Konfiguration
- **Postfix-Analyse**: Service-Status, Queue, Konfiguration
- **Andere Mailserver**: Dovecot, Exim, Sendmail Erkennung
- **Queue-√úberwachung**: E-Mail-Queue-Status und -Probleme
- **Log-Analyse**: Mailserver-Logs und Fehler-Erkennung
- **Spam/Blacklist-Monitoring**: Spam- und Blacklist-Probleme

### ü§ñ **Intelligenter Ollama-Chat**
- **Dynamische Modell-Auswahl**: Intelligente Auswahl basierend auf Komplexit√§t
- **K√ºrzelw√∂rter**: Schnelle Zugriffe auf h√§ufige Fragen
- **Intelligentes Caching**: Optimierte Performance f√ºr wiederholte Fragen
- **Automatische System-Analyse**: Detaillierte Einblicke beim Start
- **Deutsche √úbersetzungen**: Vollst√§ndig lokalisierte Benutzeroberfl√§che
- **Automatische Berichterstellung**: Professionelle Systemberichte mit Handlungsanweisungen

### ‚ö° **Performance-Optimierungen**
- **Quick-Modus**: √úberspringt zeitaufw√§ndige Analysen
- **Intelligente Fehlerbehandlung**: Gruppierte Fehler-Zusammenfassung
- **Modell-Auswahl**: Automatische Komplexit√§ts-Erkennung
- **Cache-System**: Vermeidung redundanter API-Aufrufe
- **Asynchrone Analyse**: Hintergrund-Analyse f√ºr sofortige Men√º-Anzeige
- **Debug-Modus**: Detaillierte Ausgaben f√ºr Entwickler

### üîê **Intelligente Sudo-Unterst√ºtzung**
- **Automatische Rechte-Pr√ºfung**: Erkennt Permission-Denied-Fehler und pr√ºft Sudo-Verf√ºgbarkeit
- **Sichere Befehls-Whitelist**: Nur lesende Befehle werden mit Sudo ausgef√ºhrt
- **Gef√§hrliche Befehle blockiert**: L√∂sch-, Modifikations- und System-Befehle werden niemals mit Sudo ausgef√ºhrt
- **Passwortlose Sudo-Pr√ºfung**: Testet automatisch ob Sudo ohne Passwort funktioniert
- **Fallback-Mechanismus**: Bei Sudo-Problemen wird normaler Modus verwendet
- **Transparente Ausf√ºhrung**: Benutzer wird √ºber Sudo-Nutzung informiert

### üîí **Netzwerk-Sicherheitsanalyse**
- **Interne Service-Erkennung**: Lauschende Ports, Firewall-Status, externe Interfaces
- **Externe Erreichbarkeitstests**: Nmap-Scans, Banner-Grabbing, Service-Versionen
- **Automatisierte Verbindungstests**: Telnet, Netcat, HTTP, SSH
- **Sicherheitsbewertung**: Risiko-Level (low/medium/high/critical), Empfehlungen, Compliance-Probleme
- **Chat-Integration**: `network-security`, `exposed-services`, `port-scan`, `service-test` Shortcuts
- **Sichere Sudo-Nutzung**: Netzwerk-Tools werden nur mit Sudo ausgef√ºhrt wenn sicher

## üìã Voraussetzungen

### System-Anforderungen
- **Python 3.8+**
- **SSH-Zugang** zum Zielsystem
- **Ollama** lokal installiert und laufend
- **kubectl** (optional, f√ºr Kubernetes-Analyse)

### Python-Pakete
```bash
pip install rich requests paramiko
```

## üõ†Ô∏è Installation

### Basis-Installation

1. **Repository klonen**:
```bash
git clone https://github.com/ssachse/ai_loganalyser.git
cd ai_loganalyser
```

2. **Abh√§ngigkeiten installieren**:
```bash
pip install -r requirements.txt
```

3. **Ollama starten**:
```bash
ollama serve
```

### √úbersetzungen generieren

Die √úbersetzungen werden automatisch mit Ollama generiert:

```bash
# Statische √úbersetzungen generieren (erfordert Ollama)
python3 generate_translations.py

# Dynamische √úbersetzungen werden automatisch generiert
# wenn unbekannte Locales erkannt werden

# Oder manuell mit gettext (erfordert gettext-Installation)
msgfmt -o locale/de/LC_MESSAGES/ai_loganalyser.mo locale/de/LC_MESSAGES/ai_loganalyser.po
msgfmt -o locale/en/LC_MESSAGES/ai_loganalyser.mo locale/en/LC_MESSAGES/ai_loganalyser.po
```

**Hinweis**: Falls gettext nicht installiert ist:
- **macOS**: `brew install gettext`
- **Ubuntu**: `sudo apt-get install gettext`
- **Windows**: Download von https://www.gnu.org/software/gettext/

### Dynamische √úbersetzung testen

```bash
# Demo der dynamischen √úbersetzung
python3 demo_dynamic_translation.py

# Umfassende Tests
python3 test_dynamic_translation.py
```

## üöÄ Verwendung

### Grundlegende Verwendung
```bash
python3 ssh_chat_system.py user@hostname
```

### Erweiterte Optionen
```bash
# Quick-Modus (schnelle Analyse)
python3 ssh_chat_system.py user@hostname --quick

# Ohne Log-Sammlung (nur System-Info)
python3 ssh_chat_system.py user@hostname --no-logs

# Debug-Modus (detaillierte Ausgaben)
python3 ssh_chat_system.py user@hostname --debug

# Benutzerdefinierte SSH-Parameter
python3 ssh_chat_system.py user@hostname --port 2222 --key-file ~/.ssh/id_rsa

# Tempor√§re Dateien behalten
python3 ssh_chat_system.py user@hostname --keep-files
```

### Chat-K√ºrzelw√∂rter
```
System:
services    - Welche Services laufen auf dem System?
storage     - Wie ist der Speicherplatz?
security    - Gibt es Sicherheitsprobleme?
performance - Wie ist die System-Performance?
users       - Welche Benutzer sind aktiv?
updates     - Gibt es verf√ºgbare System-Updates?
logs        - Was zeigen die Logs?

Kubernetes:
k8s         - Wie ist der Kubernetes-Cluster-Status?
k8s-problems- Welche Kubernetes-Probleme gibt es?
k8s-pods    - Welche Pods laufen im Cluster?
k8s-nodes   - Wie ist der Node-Status?
k8s-resources- Wie ist die Ressourcen-Auslastung?

Proxmox:
proxmox     - Wie ist der Proxmox VE-Status?
proxmox-problems- Welche Proxmox-Probleme gibt es?
proxmox-vms - Welche VMs laufen auf Proxmox?
proxmox-containers- Welche Container laufen auf Proxmox?
proxmox-storage- Wie ist der Proxmox-Speicherplatz?

Docker:
docker      - Wie ist der Docker-Status und welche Container laufen?
docker-problems- Welche Docker-Probleme gibt es?
docker-containers- Welche Docker-Container laufen?
docker-images- Welche Docker-Images sind installiert?

Mailserver:
mailservers - Welche Mailserver sind installiert und aktiv?
mailcow     - Wie ist der Mailcow-Status?
mailcow-problems- Welche Mailcow-Probleme gibt es?
postfix     - Wie ist der Postfix-Status?
postfix-problems- Welche Postfix-Probleme gibt es?

Berichte & Tools:
report      - Erstelle einen detaillierten Systembericht mit Handlungsanweisungen
help        - Zeige verf√ºgbare K√ºrzelw√∂rter
```

## üîß Konfiguration

### SSH-Verbindung
- **Standard-Port**: 22
- **Authentifizierung**: Passwort oder SSH-Key
- **Timeout**: 30 Sekunden pro Befehl

### Ollama-Integration
- **Standard-Port**: 11434
- **Modelle**: Intelligente Auswahl basierend auf Modellnamen und Komplexit√§t
- **Cache**: Intelligentes Caching f√ºr optimale Performance
- **Modell-Priorit√§ten**: 
  - **Men√º**: `qwen:0.5b` (ultraschnell)
  - **Einfache Analysen**: `qwen:0.5b` ‚Üí `llama3.2:3b`
  - **Komplexe Analysen**: `llama3.1:8b` ‚Üí `deepseek-r1:14b` ‚Üí `mistral:7b`
- **Report-Generierung**: Verwendet `llama3.1:8b` f√ºr professionelle Berichte

### Kubernetes-Analyse
- **Automatische Erkennung**: Pr√ºft `kubectl` Verf√ºgbarkeit
- **Berechtigungen**: Erfordert Cluster-Zugriff
- **Fehlerbehandlung**: Gruppierte kubectl-Fehler

### Docker-Analyse
- **Automatische Erkennung**: Pr√ºft `docker` Verf√ºgbarkeit
- **Berechtigungen**: Erfordert Docker-Gruppen-Mitgliedschaft
- **Container-√úberwachung**: Laufende und gestoppte Container
- **Image-Management**: Verf√ºgbare und ungenutzte Images
- **Volume-√úberwachung**: Docker-Volumes und deren Status

### Mailserver-Analyse
- **Mailcow-Erkennung**: Pr√ºft `/opt/mailcow-dockerized/` Verzeichnis
- **Postfix-Erkennung**: Pr√ºft `postfix` Service und Konfiguration
- **Andere Mailserver**: Automatische Erkennung von Dovecot, Exim, Sendmail
- **Log-Analyse**: Mailserver-Logs und Fehler-Erkennung
- **Queue-√úberwachung**: E-Mail-Queue-Status und -Probleme

### üìä **Automatische Berichterstellung**
- **CRAFT-Prompt**: Professioneller Enterprise-Architekt-Prompt
- **Markdown-Export**: Strukturierte Berichte als `.md` Dateien
- **Automatische Speicherung**: `system_reports/` Verzeichnis mit Timestamp
- **Deutsche Berichte**: Vollst√§ndig auf Deutsch erstellte Berichte
- **Strukturierte Ausgabe**: Executive Summary, Ma√ünahmen√ºbersicht, Detail-Actionplan
- **Priorisierung**: Impact/Aufwand-Bewertung mit Quick Wins ‚Üí Mid-Term ‚Üí Long-Term

## üìä Ausgabe-Beispiele

### System-√úbersicht
```
üìä System-√úbersicht
============================================================
                    System-Basis-Informationen                     
‚îè‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚î≥‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îì
‚îÉ Eigenschaft          ‚îÉ Wert                                     ‚îÉ
‚î°‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚ïá‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚î©
‚îÇ Hostname             ‚îÇ server.example.com                       ‚îÇ
‚îÇ Distribution         ‚îÇ Ubuntu 22.04.5 LTS                       ‚îÇ
‚îÇ Kernel               ‚îÇ 5.15.0-139-generic                       ‚îÇ
‚îÇ CPU                  ‚îÇ AMD EPYC-Rome Processor                  ‚îÇ
‚îÇ RAM                  ‚îÇ 30Gi                                     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### Kubernetes-Cluster
```
‚ò∏Ô∏è Kubernetes-Cluster
============================================================
Cluster-Informationen:
Kubernetes control plane is running at https://142.132.176.3:6443

‚ö†Ô∏è  3 Probleme gefunden:
- Nicht-ready Nodes
- Nicht-running Pods  
- Problematische Persistent Volumes
```

### Intelligente Fehlerbehandlung
```
‚ö†Ô∏è  Fehler-Zusammenfassung (8 Fehler):

üîí Fehlende Rechte (5 Fehler):
   Weitere Analyse aufgrund fehlender Rechte nicht m√∂glich.
   Betroffene Bereiche:
   ‚Ä¢ Speicherplatz-Analyse
   ‚Ä¢ Log-Datei-Zugriff

üí° Tipp: Verwenden Sie einen Benutzer mit erweiterten Rechten f√ºr vollst√§ndige Analyse.
```

### Docker-Container-Analyse
```
üê≥ Docker-Container-Analyse
============================================================
‚úÖ Docker erkannt und analysiert
üìã Version: Docker version 20.10.21
üìã Laufende Container gefunden
üìã Alle Container gefunden
üìã Docker-Images gefunden
üìã System-Nutzung gefunden

‚ö†Ô∏è  2 Probleme gefunden:
- Gestoppte Container: container1, container2
- Ungenutzte Images: image1, image2
```

### Mailserver-Analyse
```
üìß Mailserver-Analyse
============================================================
‚úÖ Mailserver erkannt und analysiert
üìß Mailcow erkannt
  üìã Version: 2023.01
  üìã Status verf√ºgbar
üìß Postfix erkannt
  üìã Version: postfix-3.6.4
  üìã Status verf√ºgbar
  üìã Queue-Status verf√ºgbar
```

### üìÑ **Automatische Berichterstellung**
```
‚úÖ Bericht erfolgreich erstellt:
üìÑ system_reports/system_report_server_20250723_143022.md

# Systembericht: server.example.com

**Erstellt am:** 23.07.2025 um 14:30 Uhr
**System:** server.example.com
**Distribution:** Ubuntu 22.04.5 LTS
**Kernel:** 5.15.0-139-generic

---

## Executive Summary

Das System zeigt mehrere kritische Punkte, die sofortige Aufmerksamkeit erfordern.

## Priorisierte Ma√ünahmen√ºbersicht

| ID | Thema | Ma√ünahme | Impact | Aufwand | Priorit√§t |
|----|-------|----------|--------|---------|-----------|
| 1 | Speicherplatz | Root-Partition erweitern | Hoch | Mittel | Kritisch |
| 2 | Sicherheit | SSH-Konfiguration h√§rten | Hoch | Niedrig | Hoch |
| 3 | Performance | Log-Rotation implementieren | Mittel | Niedrig | Mittel |

## Detail-Actionplan

### 1. Speicherplatz-Optimierung
- **Was:** Root-Partition erweitern oder Daten migrieren
- **Warum:** 75% Auslastung ist kritisch
- **Wie:** LVM erweitern oder /var auf separate Partition
- **Aufwand:** 2-4 Stunden
- **Verantwortlich:** System-Administrator
```

## üîí Sicherheit

### SSH-Sicherheit
- **Verschl√ºsselte Verbindung**: Standard SSH-Verschl√ºsselung
- **Key-basierte Authentifizierung**: Unterst√ºtzt SSH-Keys
- **Timeout-Schutz**: Verhindert h√§ngende Verbindungen

### Daten-Schutz
- **Lokale Verarbeitung**: Alle Daten bleiben lokal
- **Tempor√§re Dateien**: Automatische Bereinigung
- **Sensible Daten**: Werden nicht gespeichert

## ü§ù Beitragen

1. **Fork** das Repository
2. **Feature-Branch** erstellen (`git checkout -b feature/AmazingFeature`)
3. **Commit** die √Ñnderungen (`git commit -m 'Add some AmazingFeature'`)
4. **Push** zum Branch (`git push origin feature/AmazingFeature`)
5. **Pull Request** erstellen

## üìù Lizenz

Dieses Projekt ist unter der MIT-Lizenz lizenziert - siehe [LICENSE](LICENSE) Datei f√ºr Details.

## üôè Danksagungen

- **Ollama**: F√ºr die lokale LLM-Integration
- **Rich**: F√ºr die sch√∂ne Terminal-Ausgabe
- **Paramiko**: F√ºr die SSH-Funktionalit√§t
- **Kubernetes**: F√ºr die Container-Orchestrierung

## üìû Support

Bei Fragen oder Problemen:
- **Issues**: [GitHub Issues](https://github.com/ssachse/ai_loganalyser/issues)
- **Discussions**: [GitHub Discussions](https://github.com/ssachse/ai_loganalyser/discussions)

---

**Entwickelt mit ‚ù§Ô∏è f√ºr DevOps und System-Administratoren** 